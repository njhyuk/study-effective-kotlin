# item19 - knowlege를 반복하여 사용하지 말라

> "프로젝트에서 이미 있던 코드를 복사해서 붙여넣고 있다면, 무언가가 잘못된 것이다"

* 실용주의 프로그래머라는 책에서는 "Dont'Repeat Yourself" 라는 규칙을 DRY 규칙이라고 표현함
* DRY는 또한 SSOT(Single Source of Truth)라는 이름으로도 알려져 있음



> 내가 생각하는 복붙해도 되는 케이스 🤔
> 1. 책임과 범위가 명확하지 않은 common 모듈을 만들어서 여러 팀과 프로젝트에서 의존시키는건 지양해야 된다 생각
> 2. MSA 서비스간 느슨한 결합을 위해 동일한 feign client 코드를 여러 프로젝트에서 반복해서 만드는데, 이걸 모듈화하면 안된다고 생각

* knowlege 는 넓은 정보로 "의도적인 정보" 를 뜻함
  * ex) 상속을 하는데 특정 메서드를 오버라이드 하지 않게 강제
    * 해당 메서드가 슈퍼클래스와 동일하게 작동하길 원함 -> knowledge
  * 알고리즘의 작동 방식, UI의 형태, 원하는 결과.. 등등
* 중요한 knowledge 는 크게 두가지
  * 로직(logic) : 프로그램이 어떻게 동작하는지, 어떻게 보이는지
  * 공통 알고리즘 (common algorithm) : 원하는 동작을 하기 위한 알고리즘

## 모든 것은 변화한다

* 프로그래밍에서 유일하게 유지되는 것은 "변화하는 속성"
* 변화하는 이유
  * 회사가 사용자의 요구 또는 습관을 더 많이 알게 되었다.
    * 🤔 최근 서비스회사가 아닌 개발자분이 매일 할일이 있는게 신기하다고 말씀 주신게 기억난다.
  * 디자인 표준이 변화했다.
  * 플랫폼, 라이브러리, 도구 등이 변화해서 이에 대응해야한다.
* 오늘날 대부분의 프로젝트는 몇 달마다 요구 사항과 내부적인 구조를 계속해서 변경한다.
  * 널리 사용되는 많은 관리 시스템은 애자일하며, 요구 사항의 변화를 맞추는데 적합하다.
  * 슬랙은 글리치라는 온라인 게임 -> 게임은 중단 -> 커뮤니케이션 방식 -> 현재의 슬랙
* 변화할 때 가장 큰 적은 knowledge가 반복되어 있는 부분
  * 반복된 부분을 모두 찾고 모두 변경해야함
    * 실수가 발생하고 귀찮다.
    * 테이블 이름이 변경되면?
      * 모든 SQL 구문을 변경해야함
        * 🤔 회원번호를 넣으려고 상담시스템 엔드포인트별 CA,RA,UA 마다 다른 SQL Mapper 를 수정해준 기억
    * 반복은 확장성을 막고 쉽게 깨지게 만든다.
      * 하이버네이트, ORM, DAO를 활용할 수 있다.

## 언제 코드를 반복해도 될까?
* 독립적인 2개의 안드로이드 애플리케이션을 만드는 예시
  * 빌드 도구 설정이 비슷하므로, 추출해서 반복을 줄일 수 있다고 생각할 수 있음
  * 하지만 한쪽만 변경해야 한다면 문제가됨
    * **함께 변경될 가능성이 높은가 vs 따로 변경될 가능성이 높은가** 판단 필요
* 잘못된 코드 추출로부터 우리를 보호할 수 있는 규칙 : SRP

## 단일 책임 원칙
* 클래스를 변경하는 이유는 단 한가지여야 한다.
  * 두 액터가 같은 클래스를 변경하는 일은 없어야 한다.
    * 액터는 서로의 업무와 분야에 대해 잘 모르는 개발자로 비유
* Student 클래스 예시
  * **val 장학금포인트** - 장학금 부서에서 만듬
  * **val 인증통과여부** - 인증 부서에서 만듬
  * 이 두 프로머티는 모두 학생의 이전 학기 성적을 기반으로 계산되어 하나의 메소드로 만듬
    * calculatePointsFromPassedCourse 메소드
      ![](item19%20-%20knowlege%EB%A5%BC%20%EB%B0%98%EB%B3%B5%ED%95%98%EC%97%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80%20%EB%A7%90%EB%9D%BC/image.png)<!-- {"width":432} -->
  * 학부장이 "덜 중요한 과목은 장학금 포인트를 줄여달라"
    * calculatePointsFromPassedCourse 메소드를 수정하다가 val 인증통과여부 도 건들게됨
    * 인증을 통과할 줄 알았던 학생이 통과하지 못할 수 있다.
  * 단위테스트를 제대로 만들었다면 미리 방지할 수 있다.
  * 해결 방법
    * 책임에 따라 다른 클래스로 만들어야 한다.
    * StudentIsPassingValidator : 인증 통과 검증 역할
    * StudentQualifiesForScholarshipValidator : 장학금 검증 역할
    * 또는 코틀린의 확장함수 확용![](item19%20-%20knowlege%EB%A5%BC%20%EB%B0%98%EB%B3%B5%ED%95%98%EC%97%AC%20%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80%20%EB%A7%90%EB%9D%BC/image%202.png)<!-- {"width":442} -->
  * 따라서 서로 다른 곳 (다른 부서) 에서 사용하는 knowledge 는 독립적으로 변경될 가능성이 많다.
    * 비슷한 처리를 하더라도 완전히 다르게 취급하는 것이 좋다.

#이펙티브-코틀린